(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2049a864"],{"03cb":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("el-card",{staticClass:"card",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addUser}},[e._v("新增角色")])],1),a("el-dialog",{attrs:{title:"编辑用户",width:"40%",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{model:e.form,"label-width":"80px",size:"normal"}},[a("el-form-item",{attrs:{label:"角色名称"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),a("el-form-item",{attrs:{label:"角色编码"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.form.roleCode,callback:function(t){e.$set(e.form,"roleCode",t)},expression:"form.roleCode"}})],1),a("el-form-item",{attrs:{label:"角色描述"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("el-form-item",{attrs:{label:"选择菜单"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-checkbox",{on:{change:e.changeExpand},model:{value:e.expandAll,callback:function(t){e.expandAll=t},expression:"expandAll"}},[e._v("展开/关闭")])],1),a("el-col",{attrs:{span:6}},[a("el-checkbox",{on:{change:e.changeSelect},model:{value:e.selectAll,callback:function(t){e.selectAll=t},expression:"selectAll"}},[e._v("全选/取消全选")])],1)],1),a("el-tree",{ref:"tree",attrs:{"node-key":"id",data:e.menuList,props:e.props,"show-checkbox":""}})],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:3,offset:16}},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")])],1),e.uptShow?e._e():a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.saveUser}},[e._v("确定")])],1),e.uptShow?a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.updateUser}},[e._v("更新")])],1):e._e()],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.articleList,border:""}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号",fixed:""}}),a("el-table-column",{attrs:{align:"center",prop:"roleName",label:"角色名称"}}),a("el-table-column",{attrs:{align:"center",prop:"roleCode",label:"角色编码"}}),a("el-table-column",{attrs:{align:"center",prop:"remark",label:"备注"}}),a("el-table-column",{attrs:{align:"center",prop:"createTime",label:"添加时间"}}),a("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(a){return e.edit(t.row.id)}}},[e._v("编辑")]),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"danger",size:"small"},on:{click:function(a){return e.del(t.row.id)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.page.currentPage,"page-sizes":e.page.pageSizes,"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},s=[],n=(a("99af"),a("0c6d"));function i(e,t){return Object(n["a"])({url:"/admin/sysAuth/role/findRolesByPage/".concat(e,"/").concat(t)})}function o(e){return Object(n["a"])({url:"/admin/sysAuth/role/removeRole/".concat(e),method:"delete"})}function l(){return Object(n["a"])({url:"/admin/sysAuth/permission/findAllPermissions"})}function c(e){return Object(n["a"])({url:"/admin/sysAuth/role/saveRolePermissions",method:"post",data:e})}function u(e){return Object(n["a"])({url:"/admin/sysAuth/role/updateRolePermissions",method:"put",data:e})}function d(e){return Object(n["a"])({url:"/admin/sysAuth/role/findRolePermissions/".concat(e)})}var p=a("1b62"),g=a("5c96"),h={mixins:[p["a"]],data:function(){return{dialogVisible:!1,articleList:[],listLoading:!1,form:{permissionIds:[]},uptShow:!1,menuList:[],props:{label:"title",children:"children"},expandAll:!1,selectAll:!1}},created:function(){var e=this;this.getArticleListInit(),l().then((function(t){e.menuList=t.data.menus}))},methods:{initData:function(){this.page.currentPage=1,this.getArticleListInit()},reset:function(){this.searchForm={}},search:function(){this.page.currentPage=1,this.getArticleListInit()},getArticleListInit:function(){var e=this;this.listLoading=!0,i(this.page.currentPage,this.page.size).then((function(t){t.success?(e.articleList=t.data.rows,e.page.total=t.data.total):e.$message.error("请求失败"),e.listLoading=!1}))},handleSizeChange:function(e){this.page.size=e,this.page.currentPage=1,this.getArticleListInit()},handleCurrentChange:function(e){this.page.currentPage=e,this.getArticleListInit()},edit:function(e){var t=this;this.expandAll=!1,this.selectAll=!1;var a=this.$refs.tree.store.nodesMap;for(var r in a)a[r].expanded=!1,a[r].checked=!1;d(e).then((function(e){t.form=e.data.role})),this.dialogVisible=!0,this.uptShow=!0},del:function(e){var t=this;o(e).then((function(e){e.success&&(Object(g["Message"])({message:"删除成功",type:"success",duration:5e3}),t.page.currentPage=1,t.getArticleListInit())}))},addUser:function(){this.form={},this.dialogVisible=!0},saveUser:function(){var e=this,t=[],a=this.$refs.tree.store.nodesMap;for(var r in a)a[r].checked&&t.push(a[r].data.id);this.form.permissionIds=t,c(this.form).then((function(t){var a=t.success,r=t.message;a?(g["Message"].success("添加成功"),e.dialogVisible=!1,e.page.currentPage=1,e.getArticleListInit()):g["Message"].error(r)}))},updateUser:function(){var e=this;u(this.form).then((function(t){var a=t.success,r=t.message;a?(g["Message"].success("更新成功"),e.uptShow=!1,e.dialogVisible=!1,e.page.currentPage=1,e.getArticleListInit()):g["Message"].error(r)}))},changeExpand:function(e){var t=this.$refs.tree.store.nodesMap;for(var a in t)t[a].expanded=e},changeSelect:function(e){var t=this.$refs.tree.store.nodesMap;for(var a in t)t[a].checked=e}}},f=h,m=(a("cd1b"),a("2877")),b=Object(m["a"])(f,r,s,!1,null,"22407710",null);t["default"]=b.exports},"0bf9":function(e,t,a){},"0c6d":function(e,t,a){"use strict";a("d3b7");var r,s=a("bc3a"),n=a.n(s),i=a("5c96"),o=a("4360"),l=a("5fc1"),c=void 0;r="http://leju.bufan.cloud";var u=n.a.create({baseURL:r,timeout:5e3});u.interceptors.request.use((function(e){return Object(l["a"])()&&(e.headers["token"]=Object(l["a"])()),e}),(function(e){return console.log(e),Promise.reject(e)})),u.interceptors.response.use((function(e){var t=e.data;return 2e4!==t.code?(Object(i["Message"])({message:t.message||"Error",type:"error",duration:5e3}),20002===t.code&&(Object(l["c"])(),Object(l["d"])(),c.$router.push("/login")),50008!==t.code&&50012!==t.code&&50014!==t.code||i["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){o["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.message||"Error"))):t}),(function(e){return console.log("err"+e),Object(i["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)})),t["a"]=u},"1b62":function(e,t,a){"use strict";var r=a("5fc1");t["a"]={data:function(){return{page:{currentPage:1,size:10,pageSizes:[10,15,20,25],total:0},uploadfilesOss:"/lejuAdmin/material/uploadFileOss"}},computed:{token:function(){return{token:Object(r["a"])()}}}}},cd1b:function(e,t,a){"use strict";a("0bf9")}}]);